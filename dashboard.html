<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Painel do Instalador — Webartec</title>
  <link rel="icon" type="image/png" href="assets/favicon.png"/>
  <link rel="stylesheet" href="static/styles.css">
</head>
<body>
<header>
  <div class="container nav">
    <div class="brand">
      <a href="index.html" style="display:flex;align-items:center;gap:12px">
        <img src="assets/logo.png" alt="Webartec"><h1>Webartec</h1>
      </a>
    </div>
    <div class="actions"></div>
  </div>
</header>

<section class="hero">
  <div class="container inner" style="grid-template-columns:1fr;">
    <div>
      <h2 class="title-xl">Painel do Instalador</h2>
      <p class="sub">Atualize seu perfil e acompanhe sua situação.</p>
      <div id="statusBanner" style="display:none; margin-top:10px; padding:12px; border-radius:12px; background:#FFE8E8; color:#8A1C1C; font-weight:700">
        Aguardando aprovação do admin
      </div>
    </div>
  </div>
</section>

<section>
  <div class="container grid-2">
    <div class="form-card">
      <h3 class="section-title">Meu Perfil</h3>
      <div class="form-grid">
        <div><label>Empresa</label><input id="company" class="input"/></div>
        <div><label>Cidade</label><input id="city" class="input"/></div>
        <div><label>WhatsApp</label><input id="whatsapp" class="input"/></div>
        <div><label>Preço</label><input id="price" type="number" class="input"/></div>
      </div>
      <div style="margin-top:10px">
        <label>Serviços</label>
        <div class="form-grid-3" id="svcContainer"></div>
      </div>

      <div style="margin-top:10px">
        <label>Plano atual</label>
        <div class="form-grid-3">
          <label><input type="radio" name="plan_ro" value="gratis" disabled> Grátis</label>
          <label><input type="radio" name="plan_ro" value="destaque" disabled> Destaque</label>
          <label><input type="radio" name="plan_ro" value="exclusivo" disabled> Exclusivo</label>
        </div>
        <p class="help">Para mudar de plano use o botão abaixo.</p>
        <a class="btn btn-blue" id="btnUpgrade" href="checkout.html">Fazer upgrade</a>
      </div>

      <div style="margin-top:14px;display:flex;gap:10px">
        <button class="btn btn-blue" id="save">Salvar perfil</button>
        <a class="btn btn-ghost" href="#" id="viewProfile">Ver perfil</a>
      </div>
      <p class="help" id="status"></p>
    </div>

    <div class="card">
      <h3 class="section-title">Status</h3>
      <p>Plano atual: <span id="planBadge" class="badge-small">-</span></p>
      <p>Aprovação: <strong id="approved">-</strong></p>
    </div>
  </div>
</section>

<footer>
  <div class="container" style="display:flex; align-items:center; justify-content:space-between; gap:16px; flex-wrap:wrap;">
    <div class="brand">
      <img src="assets/logo-white.png" alt="Webartec"/>
      <span>© 2025 Webartec • Todos os direitos reservados</span>
    </div>
  </div>
</footer>

<script src="static/app.js"></script>
<script src="static/session.js"></script>
<script src="static/dashboard.js"></script>
<!-- no final do dashboard.html -->
<script>
document.getElementById('save')?.addEventListener('click', async ()=>{
  const body = {
    company_name: document.getElementById('company')?.value || '',
    city: document.getElementById('city')?.value || '',
    whatsapp: document.getElementById('whatsapp')?.value || '',
    price: document.getElementById('price')?.value || '',
    services: Array.from(document.querySelectorAll('#svcContainer input[type=checkbox]:checked')).map(c=>c.value)
  };
  const r = await fetch('api/installers/update_profile.php', {
    method:'POST',
    credentials:'include',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify(body)
  });
  const st = document.getElementById('status');
  if(r.ok){ st.textContent = 'Perfil salvo com sucesso.'; }
  else { st.textContent = 'Erro ao salvar perfil.'; }
});
</script>
	
</body>
</html>
